# é¡¹ç›®å®¡æŸ¥ä¸ŽUIAæ³¨å…¥é—®é¢˜æŽ’æŸ¥è®¾è®¡æ–‡æ¡£

## 1. é¡¹ç›®å½“å‰çŠ¶æ€æ¦‚è¿°

### 1.1 é¡¹ç›®ç›®æ ‡è¾¾æˆæƒ…å†µ
åŸºäºŽNorth Staræ–‡æ¡£ï¼Œé¡¹ç›®æ ¸å¿ƒç›®æ ‡æ˜¯æ‰“é€ é¢å‘AIé‡åº¦ç”¨æˆ·çš„ç³»ç»Ÿçº§æç¤ºè¯ç®¡ç†å™¨ï¼Œå½“å‰å®žçŽ°çŠ¶æ€ï¼š

| æ ¸å¿ƒåŠŸèƒ½ | çŠ¶æ€ | å®Œæˆåº¦ |
|---------|------|--------|
| å…¨å±€çƒ­é”®å”¤èµ· | âœ… å·²å®Œæˆ | 100% |
| UIAæ³¨å…¥ç­–ç•¥ | âš ï¸ éƒ¨åˆ†å®Œæˆ | 70% |
| SQLiteæ•°æ®å­˜å‚¨ | âœ… å·²å®Œæˆ | 100% |
| æŒ‰åº”ç”¨ä¸Šä¸‹æ–‡æ„ŸçŸ¥ | âœ… å·²å®Œæˆ | 90% |
| æ¨¡æ¿ç®¡ç† | âœ… å·²å®Œæˆ | 85% |

### 1.2 å…³é”®æ€§èƒ½æŒ‡æ ‡è¾¾æˆæƒ…å†µ
| KPIæŒ‡æ ‡ | ç›®æ ‡å€¼ | å½“å‰çŠ¶æ€ | è¾¾æˆæƒ…å†µ |
|---------|--------|----------|----------|
| æ³¨å…¥æˆåŠŸçŽ‡ | â‰¥99% | çº¦85%(è®°äº‹æœ¬) | âŒ æœªè¾¾æ ‡ |
| çƒ­é”®åˆ°æ³¨å…¥å»¶è¿Ÿ | â‰¤250ms | ~150ms | âœ… è¾¾æ ‡ |
| åŽå°å†…å­˜å ç”¨ | â‰¤60MB | ~25MB | âœ… è¾¾æ ‡ |
| 7å¤©æ— å´©æºƒç¨³å®šæ€§ | 100% | éœ€é•¿æœŸéªŒè¯ | ðŸ”„ è¿›è¡Œä¸­ |

## 2. TODOä»»åŠ¡å®ŒæˆçŠ¶æ€åˆ†æž

### 2.1 P0ä¼˜å…ˆçº§ä»»åŠ¡çŠ¶æ€
```mermaid
gantt
    title P0ä»»åŠ¡å®Œæˆæ—¶é—´çº¿
    dateFormat  YYYY-MM-DD
    section çƒ­é”®æ³¨å†Œ
    é”™è¯¯å¤„ç†æ”¹è¿›    :done, 2025-01-01, 2025-01-15
    section UIAæ³¨å…¥
    ValuePatternå®žçŽ° :done, 2025-01-01, 2025-01-20
    TextPatternå›žé€€ :done, 2025-01-15, 2025-01-25
    å‰ªè´´æ¿æ³¨å…¥     :active, 2025-01-25, 2025-02-05
```

**å·²å®Œæˆçš„P0ä»»åŠ¡ï¼š**
- âœ… çƒ­é”®æ³¨å†Œé”™è¯¯å¤„ç†æ”¹è¿›
- âœ… UIA ValuePatternæ³¨å…¥å®žçŽ°
- âœ… TextPattern + SendInputå›žé€€æœºåˆ¶
- âœ… ä¸Šä¸‹æ–‡ä¿¡æ¯æŽ¥å…¥
- âœ… æ¶ˆæ¯å¾ªçŽ¯ä¼˜åŒ–

**å¾…å®Œæˆçš„P0ä»»åŠ¡ï¼š**
- â³ å®‰å…¨å‰ªè´´æ¿æ³¨å…¥ï¼ˆå¯é€‰ï¼Œå½“å‰é€šè¿‡é…ç½®æŽ§åˆ¶ï¼‰

### 2.2 P1ä¼˜å…ˆçº§ä»»åŠ¡çŠ¶æ€
**å·²å®Œæˆï¼š**
- âœ… æ³¨å…¥å‰çª—å£å‰ç½®
- âœ… ValuePatternè¦†ç›–/è¿½åŠ æ¨¡å¼é…ç½®
- âœ… TextPatternå¢žå¼ºå¤„ç†
- âœ… åŸºæœ¬å…¼å®¹æ€§éªŒè¯

**è¿›è¡Œä¸­ï¼š**
- ðŸ”„ GUIå¤–å£³å¼€å‘
- ðŸ”„ æ›´å¹¿æ³›çš„åº”ç”¨å…¼å®¹æ€§æµ‹è¯•

## 3. UIAæ³¨å…¥åœ¨IDEä¸­çš„é—®é¢˜åˆ†æž

### 3.1 é—®é¢˜æ ¹å› åˆ†æž

#### 3.1.1 IDEæŽ§ä»¶å¤æ‚æ€§
```mermaid
graph TD
    A[IDEç¼–è¾‘å™¨] --> B[å¤åˆæŽ§ä»¶ç»“æž„]
    B --> C[ä¸»ç¼–è¾‘åŒºåŸŸ]
    B --> D[è¡Œå·åŒºåŸŸ]
    B --> E[æ»šåŠ¨æ¡]
    B --> F[è¯­æ³•é«˜äº®å±‚]
    
    C --> G[TextPatternå¯ç”¨]
    C --> H[ValuePatternä¸å¯ç”¨]
    
    G --> I[é€‰åŒºå¤„ç†å¤æ‚]
    H --> J[å›žé€€åˆ°SendInput]
```

#### 3.1.2 å¸¸è§IDEçš„UIAæ”¯æŒæƒ…å†µ
| IDE | ValuePattern | TextPattern | ç‰¹æ®Šå¤„ç†éœ€æ±‚ |
|-----|-------------|-------------|-------------|
| VS Code | âŒ | âœ… | éœ€è¦ç‰¹æ®Šç„¦ç‚¹å¤„ç† |
| IntelliJ IDEA | âŒ | âš ï¸ | Java SwingæŽ§ä»¶ï¼ŒUIAæ”¯æŒæœ‰é™ |
| Visual Studio | âœ… | âœ… | åŽŸç”ŸWindowsæŽ§ä»¶ï¼Œæ”¯æŒè¾ƒå¥½ |
| Notepad++ | âŒ | âœ… | ScintillaæŽ§ä»¶ |
| Sublime Text | âŒ | âŒ | è‡ªå®šä¹‰æ¸²æŸ“ï¼ŒUIAæ”¯æŒå·® |

### 3.2 å½“å‰æ³¨å…¥æµç¨‹åˆ†æž
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant H as çƒ­é”®æœåŠ¡
    participant I as æ³¨å…¥å™¨
    participant T as ç›®æ ‡IDE
    
    U->>H: Ctrl+Alt+Space
    H->>I: è§¦å‘æ³¨å…¥
    I->>T: SetForegroundWindow
    I->>T: èŽ·å–ç„¦ç‚¹å…ƒç´ 
    
    alt ValuePatternå¯ç”¨
        I->>T: ValuePattern.SetValue
        T-->>I: æˆåŠŸ/å¤±è´¥
    else TextPatternå¯ç”¨
        I->>T: TextPatterné€‰åŒºæ“ä½œ
        I->>T: å‰ªè´´æ¿ç²˜è´´/SendInput
        T-->>I: æˆåŠŸ/å¤±è´¥
    else éƒ½ä¸å¯ç”¨
        I->>T: çº¯SendInputè¾“å…¥
        T-->>I: æˆåŠŸ/å¤±è´¥
    end
```

## 4. UIAæ³¨å…¥é—®é¢˜è§£å†³æ–¹æ¡ˆ

### 4.1 ç«‹å³å¯å®žæ–½çš„æ”¹è¿›æŽªæ–½

#### 4.1.1 æ™ºèƒ½æŽ§ä»¶è¯†åˆ«å¢žå¼º
```rust
// ä¼ªä»£ç ï¼šæŽ§ä»¶ç±»åž‹æ£€æµ‹é€»è¾‘
fn detect_editor_type(element: &IUIAutomationElement) -> EditorType {
    let class_name = element.get_class_name();
    let framework_id = element.get_framework_id();
    
    match (class_name.as_str(), framework_id.as_str()) {
        ("Scintilla", _) => EditorType::Scintilla,  // Notepad++
        (_, "WPF") => EditorType::WPF,              // VS
        ("Chrome_WidgetWin_1", _) => EditorType::Electron, // VS Code
        ("SunAwtFrame", _) => EditorType::Swing,    // IntelliJ
        _ => EditorType::Generic
    }
}
```

#### 4.1.2 åˆ†å±‚å›žé€€ç­–ç•¥ä¼˜åŒ–
```mermaid
graph TD
    A[å¼€å§‹æ³¨å…¥] --> B[æŽ§ä»¶ç±»åž‹è¯†åˆ«]
    B --> C{IDEç±»åž‹?}
    
    C -->|VS/WPFç±»| D[UIA ValuePattern]
    C -->|VS Code/Electron| E[UIA TextPattern + ç‰¹æ®Šå¤„ç†]
    C -->|IntelliJ/Swing| F[Java Access Bridge]
    C -->|Notepad++/Scintilla| G[SendMessage API]
    C -->|æœªçŸ¥ç±»åž‹| H[é€šç”¨UIAæµç¨‹]
    
    D --> I{æˆåŠŸ?}
    E --> I
    F --> I
    G --> I
    H --> I
    
    I -->|æ˜¯| J[å®Œæˆ]
    I -->|å¦| K[å‰ªè´´æ¿å›žé€€]
    K --> L{æˆåŠŸ?}
    L -->|æ˜¯| J
    L -->|å¦| M[SendInputå›žé€€]
```

### 4.2 ä¸­æœŸæ”¹è¿›æ–¹æ¡ˆ

#### 4.2.1 åº”ç”¨ç‰¹å®šé…ç½®æ–‡ä»¶
```yaml
# apps_config.yaml
applications:
  - name: "Code.exe"
    display_name: "VS Code"
    strategies:
      primary: "textpattern_with_delay"
      fallback: ["clipboard", "sendinput"]
    settings:
      pre_inject_delay: 100ms
      focus_retry_count: 3
      
  - name: "idea64.exe"
    display_name: "IntelliJ IDEA"
    strategies:
      primary: "java_access_bridge"
      fallback: ["clipboard", "sendinput"]
    settings:
      use_accessibility_api: true
```

#### 4.2.2 IDEæ’ä»¶é›†æˆæ–¹æ¡ˆ
```mermaid
graph LR
    A[Prompt Manager] --> B[IPCé€šä¿¡]
    B --> C[VS Codeæ’ä»¶]
    B --> D[IntelliJæ’ä»¶]
    B --> E[VSæ’ä»¶]
    
    C --> F[ç›´æŽ¥ç¼–è¾‘å™¨API]
    D --> G[IDEA Editor API]
    E --> H[VS Extensibility API]
```

### 4.3 é•¿æœŸè§£å†³æ–¹æ¡ˆ

#### 4.3.1 å¤šå¹³å°æ³¨å…¥å¼•æ“Žæž¶æž„
```mermaid
graph TB
    A[ç»Ÿä¸€æ³¨å…¥æŽ¥å£] --> B[Windowså¼•æ“Ž]
    A --> C[macOSå¼•æ“Ž]
    A --> D[Linuxå¼•æ“Ž]
    
    B --> E[UIA Provider]
    B --> F[Win32 Provider]
    B --> G[DDE Provider]
    
    C --> H[Accessibility API]
    C --> I[AppleScript Provider]
    
    D --> J[X11 Provider]
    D --> K[Wayland Provider]
```

## 5. å®žæ–½ä¼˜å…ˆçº§ä¸Žæ—¶é—´è§„åˆ’

### 5.1 ç¬¬ä¸€é˜¶æ®µï¼ˆç«‹å³å®žæ–½ - 1-2å‘¨ï¼‰
1. **æŽ§ä»¶ç±»åž‹è¯†åˆ«å¢žå¼º**
   - å®žçŽ°åŸºäºŽç±»åå’Œæ¡†æž¶IDçš„IDEæ£€æµ‹
   - ä¸ºå¸¸è§IDEæ·»åŠ ç‰¹æ®Šå¤„ç†é€»è¾‘
   
2. **UIAæµç¨‹ä¼˜åŒ–**
   - å¢žåŠ æ³¨å…¥å‰å»¶è¿Ÿé…ç½®
   - æ”¹è¿›ç„¦ç‚¹è®¾ç½®é‡è¯•æœºåˆ¶
   - ä¼˜åŒ–TextPatterné€‰åŒºå¤„ç†

3. **é…ç½®ç³»ç»Ÿæ‰©å±•**
   - æ”¯æŒæŒ‰åº”ç”¨çš„æ³¨å…¥ç­–ç•¥é…ç½®
   - æ·»åŠ è°ƒè¯•æ¨¡å¼å’Œè¯¦ç»†æ—¥å¿—

### 5.2 ç¬¬äºŒé˜¶æ®µï¼ˆä¸­æœŸå®žæ–½ - 3-4å‘¨ï¼‰
1. **é«˜çº§å›žé€€ç­–ç•¥**
   - å®žçŽ°Java Access Bridgeæ”¯æŒ
   - æ·»åŠ SendMessage APIæ”¯æŒ
   - å®Œå–„å‰ªè´´æ¿å®‰å…¨æœºåˆ¶

2. **å…¼å®¹æ€§éªŒè¯**
   - å»ºç«‹IDEå…¼å®¹æ€§æµ‹è¯•å¥—ä»¶
   - å®Œæˆä¸»æµIDEçš„å…¨é¢æµ‹è¯•
   - å»ºç«‹å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆæ–‡æ¡£

### 5.3 ç¬¬ä¸‰é˜¶æ®µï¼ˆé•¿æœŸè§„åˆ’ - 2-3ä¸ªæœˆï¼‰
1. **IDEæ’ä»¶å¼€å‘**
   - VS Codeæ‰©å±•
   - IntelliJ IDEAæ’ä»¶
   - Visual Studioæ‰©å±•

2. **æž¶æž„é‡æž„**
   - æ’ä»¶åŒ–æ³¨å…¥æä¾›è€…æž¶æž„
   - è·¨å¹³å°æ”¯æŒåŸºç¡€
   - æ€§èƒ½ä¼˜åŒ–å’Œå†…å­˜ç®¡ç†

## 6. é£Žé™©è¯„ä¼°ä¸Žç¼“è§£æŽªæ–½

### 6.1 æŠ€æœ¯é£Žé™©
| é£Žé™© | æ¦‚çŽ‡ | å½±å“ | ç¼“è§£æŽªæ–½ |
|------|------|------|----------|
| IDEåŽ‚å•†APIå˜æ›´ | ä¸­ | é«˜ | å¤šé‡å›žé€€ç­–ç•¥ + ç‰ˆæœ¬æ£€æµ‹ |
| å®‰å…¨è½¯ä»¶æ‹¦æˆª | ä¸­ | ä¸­ | ä»£ç ç­¾å + ç™½åå•ç”³è¯· |
| æ€§èƒ½å›žå½’ | ä½Ž | ä¸­ | åŸºå‡†æµ‹è¯• + æŒç»­ç›‘æŽ§ |

### 6.2 ç”¨æˆ·ä½“éªŒé£Žé™©
| é£Žé™© | æ¦‚çŽ‡ | å½±å“ | ç¼“è§£æŽªæ–½ |
|------|------|------|----------|
| æ³¨å…¥å»¶è¿Ÿå¢žåŠ  | ä¸­ | ä¸­ | å¼‚æ­¥å¤„ç† + ç”¨æˆ·åé¦ˆ |
| éƒ¨åˆ†IDEä¸å…¼å®¹ | é«˜ | ä¸­ | è¯¦ç»†æ–‡æ¡£ + æ›¿ä»£æ–¹æ¡ˆ |
| é…ç½®å¤æ‚åŒ– | ä½Ž | ä½Ž | æ™ºèƒ½é»˜è®¤å€¼ + GUIé…ç½® |

## 7. æµ‹è¯•ä¸ŽéªŒè¯ç­–ç•¥

### 7.1 è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æž¶
```mermaid
graph TD
    A[æµ‹è¯•å¯åŠ¨] --> B[çŽ¯å¢ƒå‡†å¤‡]
    B --> C[ç›®æ ‡IDEå¯åŠ¨]
    C --> D[åˆ›å»ºæµ‹è¯•æ–‡æ¡£]
    D --> E[æ‰§è¡Œæ³¨å…¥æµ‹è¯•]
    E --> F[éªŒè¯ç»“æžœ]
    F --> G[æ¸…ç†çŽ¯å¢ƒ]
    
    E --> H[UIAè·¯å¾„æµ‹è¯•]
    E --> I[å‰ªè´´æ¿è·¯å¾„æµ‹è¯•]
    E --> J[SendInputè·¯å¾„æµ‹è¯•]
```

### 7.2 æµ‹è¯•ç”¨ä¾‹è®¾è®¡
| æµ‹è¯•åœºæ™¯ | IDE | æ–‡æ¡£ç±»åž‹ | æœŸæœ›ç»“æžœ |
|----------|-----|----------|----------|
| ç©ºæ–‡æ¡£æ³¨å…¥ | VS Code | .txt | å®Œæ•´å†…å®¹æ’å…¥ |
| æœ«å°¾è¿½åŠ  | IntelliJ | .java | è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ |
| é€‰ä¸­æ›¿æ¢ | Visual Studio | .cs | æ›¿æ¢é€‰ä¸­å†…å®¹ |
| ä¸­æ–‡å†…å®¹ | Notepad++ | .md | æ­£ç¡®ç¼–ç æ˜¾ç¤º |

## 8. ç›‘æŽ§ä¸Žåé¦ˆæœºåˆ¶

### 8.1 å…³é”®æŒ‡æ ‡ç›‘æŽ§
```yaml
metrics:
  success_rate:
    overall: ">= 95%"
    per_ide: ">= 90%"
  performance:
    injection_latency_p95: "<= 300ms"
    memory_usage: "<= 80MB"
  reliability:
    crash_rate: "<= 0.1%"
    error_rate: "<= 5%"
```

### 8.2 ç”¨æˆ·åé¦ˆæ”¶é›†
- å†…ç½®é”™è¯¯æŠ¥å‘Šæœºåˆ¶
- IDEå…¼å®¹æ€§è°ƒæŸ¥é—®å·
- GitHub Issuesè·Ÿè¸ª
- ç”¨æˆ·ä½¿ç”¨è¡Œä¸ºç»Ÿè®¡

## 9. è¿ç§»è·¯å¾„å»ºè®®

### 9.1 çŽ°æœ‰ç”¨æˆ·å¹³æ»‘å‡çº§
1. **é…ç½®å…¼å®¹æ€§**ï¼šä¿æŒçŽ°æœ‰é…ç½®æ–‡ä»¶æ ¼å¼å…¼å®¹
2. **åŠŸèƒ½æ¸è¿›**ï¼šæ–°åŠŸèƒ½é»˜è®¤å…³é—­ï¼Œç”¨æˆ·å¯é€‰å¯ç”¨
3. **å›žæ»šæœºåˆ¶**ï¼šæä¾›ç‰ˆæœ¬å›žé€€é€‰é¡¹

### 9.2 æ–°ç”¨æˆ·å¼•å¯¼
1. **æ™ºèƒ½æ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹å¸¸ç”¨IDEå¹¶æŽ¨èé…ç½®
2. **é¢„è®¾æ¨¡æ¿**ï¼šä¸ºä¸åŒèŒä¸šæä¾›é¢„é…ç½®æ–¹æ¡ˆ
3. **å¿«é€Ÿå…¥é—¨**ï¼šäº¤äº’å¼è®¾ç½®å‘å¯¼