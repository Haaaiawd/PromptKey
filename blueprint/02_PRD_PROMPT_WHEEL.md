# Product Requirements Document (PRD)

**Title**: PromptWheel - Radial Quick-Access Menu  
**Status**: Approved  
**Version**: 1.0  
**Date**: 2025-12-29

## 1. Executive Summary

**Problem**: 当前的列表模式需要用户视觉扫描、鼠标定位点击，对高频使用的提示词效率不够。  
**Solution**: 提供一个半透明圆形轮盘UI，将最常用的6个提示词映射到扇形区域和数字键(1-6)，实现"所见即所选，一键上屏"的极速交互。支持翻页浏览更多提示词。

**核心价值**: 将"搜索→选择→粘贴"的三步流程压缩为"按键→选择"的两步，节省80%的操作时间。

---

## 2. Goals & Non-Goals

### Goals
- **效率提升**: 从按下热键到内容上屏 < 1秒（包含用户决策时间）
- **零学习成本**: 圆形布局直观，数字键映射符合直觉（1=12点方向，顺时针）
- **无缝集成**: 复用现有的Injector逻辑，不破坏现有功能
- **高频优化**: 自动展示使用频率Top 6，减少搜索需求

### Non-Goals (Out of Scope)
- **不支持自定义布局**: 扇形数量固定为6，位置不可调整
- **不提供复杂筛选**: 轮盘模式下无搜索框，仅通过翻页浏览
- **不支持拖拽排序**: 顺序由系统算法决定（usage_count DESC）
- **暂不支持主题自定义**: 仅提供一种默认玻璃拟态风格
- **不移除列表模式**: 原有的搜索列表功能保留作为fallback（通过主窗口或特殊快捷键进入）

---

## 3. User Stories (The "What")

### US01: 轮盘显示与交互
- **Story**: 作为用户，我希望按下`Ctrl+Shift+H`后看到一个半透明圆形轮盘，以便快速识别最常用的提示词。
- **Acceptance Criteria (AC)**:
  - [ ] 按下`Ctrl+Shift+H`后，轮盘在500ms内出现在屏幕正中心
  - [ ] 轮盘为正圆形，直径400px（可在实现阶段微调）
  - [ ] 背景使用玻璃拟态效果：`backdrop-filter: blur(10px)`, `background: rgba(255,255,255,0.15)`
  - [ ] 轮盘包含6个等分扇形区域（每个60度）
  - [ ] 窗口始终在最上层(`always-on-top: true`)
  - [ ] 按ESC键或点击轮盘外部区域时，窗口关闭
- **Priority**: P0

### US02: 扇形内容显示
- **Story**: 作为用户，我希望每个扇形清晰显示提示词名称，以便快速识别。
- **Acceptance Criteria (AC)**:
  - [ ] 每个扇形显示对应提示词的名称
  - [ ] 名称超过10个字符时，截断并显示省略号（如"我的AI编程..."）
  - [ ] 鼠标悬停在扇形上时：
    - [ ] 该扇形高亮（边框或背景变亮）
    - [ ] 轮盘中心区域显示完整的提示词名称（不截断）
  - [ ] 扇形按顺时针方向编号：1号在12点方向，2号在2点方向，依次类推
- **Priority**: P0

### US03: 快捷键选择
- **Story**: 作为用户，我希望按数字键1-6直接选择对应扇形，以便实现盲操作。
- **Acceptance Criteria (AC)**:
  - [ ] 按下数字键`1`时，选中12点方向的扇形（第1个）
  - [ ] 按下数字键`2-6`时，依次选中对应位置的扇形
  - [ ] 选中后的行为与鼠标点击一致（见US04）
  - [ ] 数字键响应延迟 < 50ms
- **Priority**: P0

### US04: 直接注入到光标
- **Story**: 作为用户，我希望选中扇形后，提示词内容直接粘贴到当前光标位置，无需手动Ctrl+V。
- **Acceptance Criteria (AC)**:
  - [ ] 点击扇形或按对应数字键后，轮盘立即隐藏
  - [ ] 系统等待100-150ms（让焦点回到原应用窗口）
  - [ ] Service执行注入逻辑，将提示词内容粘贴到光标位置
  - [ ] 复用现有`Injector`模块的策略（Clipboard → SendInput fallback）
  - [ ] 注入成功后，在数据库记录usage log，`action='wheel_select'`
  - [ ] 如果注入失败，静默失败（仅记录error log，不显示弹窗）
  - [ ] 整个流程（从点击到文字出现）耗时 < 500ms
- **Priority**: P0

### US05: 数据来源与排序
- **Story**: 作为用户，我希望轮盘自动显示我最常用的6个提示词，以便无需手动配置。
- **Acceptance Criteria (AC)**:
  - [ ] 轮盘显示的6个提示词按`usage_count DESC`排序（使用次数从高到低）
  - [ ] 如果提示词总数 <= 6，显示全部
  - [ ] 如果提示词总数 > 6，仅显示Top 6
  - [ ] 空数据库时，显示友好提示"无可用Prompts，请先添加"
- **Priority**: P0

### US06: 翻页浏览更多提示词
- **Story**: 作为用户，如果我想选择不在Top 6中的提示词，我希望能通过翻页查看后续分组。
- **Acceptance Criteria (AC)**:
  - [ ] 轮盘底部（或中心）显示翻页控制：`◀ 第1页/共3页 ▶`
  - [ ] 点击`▶`或按`Page Down`键时，显示第2组（第7-12个提示词）
  - [ ] 点击`◀`或按`Page Up`键时，返回上一页
  - [ ] 到达最后一页时，`▶`按钮禁用（灰色）
  - [ ] 到达第一页时，`◀`按钮禁用
  - [ ] 翻页时轮盘不关闭，仅刷新6个扇形的内容
  - [ ] 翻页后数字键1-6仍对应当前页的扇形
  - [ ] 如果提示词总数不是6的倍数（如8个），最后一页显示2个扇形，其余4个扇形置灰或隐藏
- **Priority**: P1

### US07: 窗口透明度与样式
- **Story**: 作为用户，我希望轮盘窗口有现代化的半透明效果，不遮挡背景内容。
- **Acceptance Criteria (AC)**:
  - [ ] 窗口背景透明度约15-20%（`rgba(255,255,255,0.15)`）
  - [ ] 应用高斯模糊效果（`backdrop-filter: blur(10px)`）
  - [ ] 窗口无边框（`decorations: false`）
  - [ ] 扇形边界有细微的半透明边框（`rgba(255,255,255,0.3)`）
  - [ ] 在深色和浅色背景下都保持可读性
- **Priority**: P1

---

## 4. Constraint Analysis

### 技术约束
- **现有架构**: 必须复用Service的`Injector`模块，不得在GUI中重新实现注入逻辑
- **IPC通信**: 需要新增Named Pipe消息`INJECT_PROMPT(id)`，让Service执行注入
- **数据库**: 需要新增SQL查询`SELECT * FROM prompts ORDER BY usage_count DESC LIMIT 6 OFFSET ?`

### 性能约束
- **响应时间**: 热键触发到轮盘显示 < 500ms
- **数字键延迟**: < 50ms
- **注入耗时**: 从选择到文字出现 < 500ms

### 兼容性约束
- **Windows透明窗口**: 必须处理Tauri在Windows上的黑色背景问题（使用`transparent: true` + 特定webview配置）
- **多屏支持**: 轮盘应始终在主屏幕中心（或活跃窗口所在屏幕中心）

### 数据约束
- **最小数据集**: 数据库至少需要1个提示词才能显示轮盘
- **最大扇形文字**: 每个扇形显示最多10个字符，超出截断

---

## 5. Assumptions & Open Questions

### Assumptions（默认假设）
1. 用户已熟悉现有的`Ctrl+Shift+H`快捷键（原列表模式）
2. 用户理解"数字键1-6"对应"顺时针12点起点"的映射关系
3. Service进程在GUI启动时已经运行（这是现有架构的前提）
4. 用户不会在同一时间按住多个数字键（不处理组合键冲突）

### Open Questions（待实现阶段确认）
- ❓ 轮盘直径400px是否合适？（可在原型阶段通过用户测试调整）
- ❓ 翻页控制放在轮盘中心还是底部？（中心更直观，底部不遮挡扇形）
- ❓ 是否需要在扇形上显示序号"1、2、3"？（可能冗余，因为有固定位置）

---

## 6. Definition of Done

- [ ] 所有P0 User Stories的AC测试通过
- [ ] 在3个不同应用中测试注入功能（VS Code, 记事本, Chrome地址栏）
- [ ] 数字键和鼠标点击都能正常工作
- [ ] 翻页功能测试通过（测试数据集 >= 12个提示词）
- [ ] 窗口在深色和浅色桌面背景下都清晰可见
- [ ] 代码Review通过
- [ ] 无新增Lint警告
- [ ] Usage log正确记录到数据库（`action='wheel_select'`）

---

## 7. Success Metrics（成功指标）

- **使用率**: 轮盘模式的调用次数 / 总提示词使用次数 > 60%
- **效率提升**: 平均选择时间 < 原列表模式的50%
- **用户留存**: 发布后7天内，至少70%的用户继续使用轮盘功能（而非回退到列表）

---

**Approved by**: 用户  
**Next Step**: 进入RFC阶段，定义技术实现方案
